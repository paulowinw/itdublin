{"version":3,"file":"presto-search-bar.js","sourceRoot":"","sources":["../../../../../../src/components/core/features/presto-search-bar/component/presto-search-bar.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Prop, State } from '@stencil/core';\nimport { searchVtt, setMarkers, removeOldMarkers } from '../../../player/functions/search-vtt';\n\n@Component({\n  tag: 'presto-search-bar',\n  shadow: false,\n})\nexport class PrestoSearchBar {\n  /**\n   * Props\n   */\n  @Prop() value: string;\n  @Prop() player: any;\n\n  /**\n   * State\n   */\n  @State() markers: any;\n  @State() currentMarkerLocation: number = -1;\n\n  /**\n   * Handle search event\n   * @param value Event\n   */\n  onSearch(e) {\n    this.value = e.detail;\n\n    if ('' === this.value) {\n      removeOldMarkers(this.player);\n      this.markers = [];\n    } else {\n      const searchResult = searchVtt(this.player, this.value);\n      this.player.config.markers = { enabled: true, points: searchResult };\n      this.markers = searchResult;\n      setMarkers(this.player, searchResult);\n    }\n  }\n\n  /**\n   * Handle previous arrow key click after search\n   */\n  onPreviousNav() {\n    const prevLocation = this.currentMarkerLocation - 1;\n    // previous location is -1\n    if (prevLocation < 0) {\n      this.currentMarkerLocation = this.markers.length - 1;\n    } else {\n      this.currentMarkerLocation--;\n    }\n    this.player.currentTime = this.markers[this.currentMarkerLocation]['time'];\n  }\n\n  /**\n   * Handle the event where search is hovered or focused\n   */\n  onFocusChange(focus) {\n    if (focus?.detail === true) {\n      this.player.config.hideControls = false;\n    } else {\n      this.player.config.hideControls = this.player.config?.preset?.auto_hide || false;\n    }\n  }\n\n  /**\n   * Handle next arrow key click after search\n   */\n  onNextNav() {\n    const nextLocation = this.currentMarkerLocation + 1;\n    if (nextLocation > this.markers.length - 1) {\n      this.currentMarkerLocation = 0;\n    } else {\n      this.currentMarkerLocation++;\n    }\n    this.player.currentTime = this.markers[this.currentMarkerLocation]['time'];\n  }\n\n  render() {\n    if (!this.player) return '';\n    if (!this.player?.media?.textTracks?.length || this.player?.media?.textTracks?.length === 0) return '';\n\n    const presets = this.player.config.preset;\n    const placeholder = presets.search?.placeholder;\n\n    return (\n      <presto-search-bar-ui\n        value={this.value}\n        hasNavigation={this.markers?.length > 1}\n        placeholder={placeholder}\n        onNextNav={() => this.onNextNav()}\n        onPreviousNav={() => this.onPreviousNav()}\n        onSearch={e => this.onSearch(e)}\n        onFocusChange={focus => this.onFocusChange(focus)}\n      ></presto-search-bar-ui>\n    );\n  }\n}\n"]}