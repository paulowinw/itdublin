{"version":3,"file":"transform-data.js","sourceRoot":"","sources":["../../../../../src/components/core/player/functions/transform-data.ts"],"names":[],"mappings":"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","sourcesContent":["import { PrestoConfig } from '../../../../interfaces';\n\n// takes our saved options and transforms them into a format that plyr.io will use\nexport default function ({\n  preset = {},\n  chapters,\n  branding,\n  src,\n  analytics,\n  automations,\n  autoplay,\n  blockAttributes = {},\n  provider = '',\n  provider_video_id = '',\n  youtube,\n  type,\n  isAdmin,\n  i18n,\n  storage = {\n    enabled: !isAdmin,\n    key: `presto-player-${preset.id}`,\n  },\n}: PrestoConfig) {\n  const controlOptions = ['play-large', 'rewind', 'play', 'fast-forward', 'progress', 'current-time', 'mute', 'volume', 'captions', 'settings', 'pip', 'fullscreen'];\n  const required = ['settings'];\n  const disabled = [...(['youtube', 'vimeo'].includes(provider) ? ['pip'] : [])];\n\n  const controls = controlOptions.filter(key => {\n    return (preset?.[key] || required.includes(key)) && !disabled.includes(key);\n  });\n\n  let playerSettings = {\n    id: blockAttributes?.id,\n    title: blockAttributes?.title || '',\n    blockAttributes: {\n      ...blockAttributes,\n      ...{ type },\n    },\n    src,\n    ajaxProgress: true,\n    analytics,\n    preset,\n    automations,\n    mutedPreview: {\n      enabled: blockAttributes?.mutedPreview?.enabled,\n    },\n    loop: {\n      active: preset?.on_video_end === 'loop' ? true : false,\n    },\n    chapters,\n    controls,\n    settings: ['captions', 'quality', 'loop', ...(preset?.speed ? ['speed'] : [])],\n    hideControls: preset?.auto_hide,\n    captions: { active: preset?.captions_enabled, language: 'auto', update: false },\n    logo: branding?.logo,\n    logo_width: branding?.logo_width,\n    hide_logo: preset?.hide_logo,\n    lazy_load_youtube: preset?.lazy_load_youtube,\n    save_player_position: !!preset?.save_player_position,\n    sticky_scroll: preset?.sticky_scroll,\n    play_video_viewport: preset?.play_video_viewport,\n    autoplay: autoplay && !window.wp?.blocks ? true : false,\n    // playsinline: !!blockAttributes?.playsInline,\n    ...(provider ? { provider } : {}),\n    ...(provider_video_id ? { provider_video_id } : {}),\n    ...(blockAttributes?.poster ? { poster: blockAttributes.poster } : {}),\n    invertTime: !(preset?.show_time_elapsed),\n    // debug: true,\n    storage,\n    keyboard: { focused: false, global: false }, // this is required so email collection doesn't trigger shortcuts.\n    resetOnEnd: !!preset?.reset_on_end,\n    vimeo: {\n      byline: false,\n      portrait: false,\n      title: false,\n      speed: true,\n      transparent: false,\n      // Custom settings from Plyr\n      customControls: true,\n      // Whether the owner of the video has a Pro or Business account\n      // (which allows us to properly hide controls without CSS hacks, etc)\n      premium: false,\n      playsinline: !!blockAttributes?.playsInline,\n      // Prevent Vimeo blocking site\n    },\n    youtube: {\n      rel: 0, // No related vids\n      showinfo: 0, // Hide info\n      iv_load_policy: 3, // Hide annotations\n      modestbranding: 1, // Hide logos as much as possible (they still show one in the corner when paused)\n      // Custom settings from Plyr\n      customControls: true,\n      noCookie: !!youtube?.noCookie, // Whether to use an alternative version of YouTube without cookies\n      playsinline: !!blockAttributes?.playsInline,\n    },\n    tooltips: {\n      controls: true,\n      seek: true,\n    },\n    // Localisation\n    i18n,\n  };\n\n  if (window?.wp?.hooks) {\n    playerSettings = window.wp.hooks.applyFilters('presto.playerSettings', playerSettings);\n  }\n\n  return playerSettings;\n}\n"]}