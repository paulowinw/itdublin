{"version":3,"file":"presto-player.js","sourceRoot":"","sources":["../../../../src/components/core/player/presto-player.tsx"],"names":[],"mappings":"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","sourcesContent":["/// <reference types=\"resize-observer-browser\" />\n\nimport { Component, Element, Event, EventEmitter, h, Host, Listen, Method, Prop, State, Watch } from '@stencil/core';\n\nimport { ActionBarConfig, blockAttributes, BunnyConfig, DynamicOverlay, i18nConfig, presetAttributes, prestoBranding, prestoChapters, PrestoConfig, SearchBarConfig, YoutubeConfig } from '../../../interfaces';\nimport { exitFullScreen } from '../../../util';\nimport cacheCues from './functions/cache-cues';\nimport createPlayer from './functions/create';\nimport customCSS from './functions/custom-css';\nimport hlsPreloadSize from './functions/hls-preload-size';\nimport mutedAutoplay from './functions/muted-autoplay';\nimport transform from './functions/transform-data';\nimport { getParents, isHLS } from './functions/util';\n\n@Component({\n  tag: 'presto-player',\n  styleUrl: 'presto-player.scss',\n  shadow: true,\n})\nexport class PrestoPlayer {\n  private originalConfig?: PrestoConfig;\n  private i18n?: i18nConfig;\n\n  @Prop() video_id: number;\n  @Prop() iconUrl: string;\n  @Prop() src: string;\n  @Prop() bunny: BunnyConfig;\n  @Prop() branding: prestoBranding;\n  @Prop() config: PrestoConfig;\n  @Prop() preset: presetAttributes;\n  @Prop() chapters: prestoChapters;\n  @Prop() overlays: Array<DynamicOverlay>;\n  @Prop() blockAttributes: blockAttributes;\n  @Prop() tracks: { label: string; src: string; srcLang: string }[];\n  @Prop() analytics: boolean;\n  @Prop() automations: boolean;\n  @Prop({ reflect: true }) provider: string;\n  @Prop() provider_video_id: string;\n  @Prop() actionBar: ActionBarConfig;\n  @Prop() youtube: YoutubeConfig;\n  @Prop() type: string;\n  @Prop({ mutable: true, reflect: true }) autoplay: boolean;\n  @Prop() preload: 'metadata' | 'none' | 'auto';\n  @Prop() poster: string;\n  @Prop() playsinline: boolean;\n  @Prop() isAdmin: boolean = false;\n  @Prop() direction?: 'rtl';\n  @Prop() css?: string;\n  @Prop() currentTime: number;\n  @Prop() mediaTitle: string;\n  @Prop() classes: string;\n  @Prop() videoAttributes: object;\n  @Prop() audioAttributes: object;\n  @Prop() search: SearchBarConfig;\n  @Prop() markers: any;\n\n  /**\n   * This element\n   */\n  @Element() el: HTMLElement;\n\n  /**\n   * Component loaded\n   */\n  @Event({ bubbles: true, composed: true }) loaded: EventEmitter<boolean>;\n\n  @Event() currentMediaPlayer: EventEmitter<object>;\n  @Event() playerReady: EventEmitter<object>;\n  @Event() playedMedia: EventEmitter<object>;\n  @Event() pausedMedia: EventEmitter<object>;\n  @Event() endedMedia: EventEmitter<object>;\n\n  /**\n   * State() variables\n   */\n  @State() player: any;\n  @State() playerEl?: HTMLVideoElement | HTMLElement;\n  @State() shouldLazyLoad: boolean;\n  @State() mutedPreview: boolean;\n  @State() duration: number;\n  @State() isSticky: boolean;\n  @State() videoHeight: number;\n  @State() playClass: string;\n  @State() previouslyPlaying: boolean = false;\n  @State() ctaActive: boolean = false;\n  @State() emailActive: boolean = false;\n  @State() actionBarActive: boolean = false;\n  @State() ready: boolean;\n\n  private observer: IntersectionObserver;\n  private overlaysComponent: HTMLPrestoDynamicOverlaysElement;\n  private components: {\n    cta: HTMLPrestoCtaOverlayElement;\n    email: HTMLPrestoEmailOverlayElement;\n    overlays: HTMLPrestoDynamicOverlaysElement;\n    search: HTMLPrestoSearchBarElement;\n  } = {\n    cta: null,\n    email: null,\n    overlays: null,\n    search: null\n  };\n\n  /**\n   * Play video\n   * @returns Plyr\n   */\n  @Method()\n  async play(unmute = false) {\n    this.shouldLazyLoad = false;\n    if (unmute) {\n      this.mutedPreview = false;\n    }\n    this.player.play();\n  }\n\n  /**\n   * Go to and play\n   * @param time number\n   */\n  @Method()\n  async goToAndPlay(time: number) {\n    this.player.play();\n    this.player.currentTime = time;\n  }\n\n  @Listen('currentMediaPlayer', { target: 'window' })\n  handleScroll(ev) {\n    if (ev.detail.id !== this.player.id) {\n      if (!this.mutedPreview) {\n        this.pause();\n      }\n    }\n  }\n\n  /**\n   * Play video\n   * @returns Plyr\n   */\n  @Method()\n  async restart() {\n    this.shouldLazyLoad = false;\n    return this.player.restart();\n  }\n\n  /**\n   * Pause video\n   * @returns Plyr\n   */\n  @Method()\n  async pause() {\n    return this.player.pause();\n  }\n\n  /**\n   * Pause video\n   * @returns Plyr\n   */\n  @Method()\n  async stop() {\n    return this.player.stop();\n  }\n\n  /**\n   * Toggle Fullscreen\n   * @returns Plyr\n   */\n  @Method()\n  async fullscreenToggle(open: boolean) {\n    return this.player.fullscreen.toggle(open);\n  }\n\n  /**\n   * Add an event listener for the specified event.\n   * @param event String\n   * @param func Function\n   * @returns Plyr\n   */\n  @Method()\n  async on(event: string, func: Function) {\n    return this.player.on(event, func);\n  }\n\n  /**\n   * Add an event listener for the specified event.\n   * @param event String\n   * @param func Function\n   * @returns Plyr\n   */\n  @Method()\n  async once(event: string, func: Function) {\n    return this.player.once(event, func);\n  }\n\n  /**\n   * Remove an event listener for the specified event.\n   * @param event String\n   * @param func Function\n   * @returns Plyr\n   */\n  @Method()\n  async off(event: string, func: Function) {\n    return this.player.off(event, func);\n  }\n\n  @Watch('currentTime')\n  async handleCurrentTimeChange(val) {\n    if (this.player && Number.isInteger(val)) {\n      // if we have duration\n      // current time shouldn't be more than duration\n      if (this.player.duration) {\n        this.player.currentTime = Math.min(this.player.currentTime, this.player.duration);\n      }\n\n      // re-initialize if lazy loading.\n      if (this.shouldLazyLoad) {\n        this.shouldLazyLoad = false;\n        await new Promise<void>(resolve => {\n          setTimeout(async () => {\n            await this.initialize();\n            resolve();\n          }, 50);\n        });\n      }\n\n      // handle lag in embeds.\n      if (this.player.embed && !this.player.playing) {\n        this.player.currentTime = val;\n        this.player.muted = true;\n        this.player.play();\n        this.player.once('timeupdate', () => {\n          this.player.pause();\n          this.player.currentTime = val;\n          this.player.muted = false;\n        });\n      } else {\n        this.player.currentTime = val;\n      }\n    }\n  }\n\n  /**\n   * Handle sticky change\n   */\n  @Watch('isSticky')\n  handleStickyChange() {\n    const parents = getParents(this.el);\n    parents.forEach(parent => {\n      parent?.classList?.toggle('presto-sticky-parent', this.isSticky);\n    });\n  }\n\n  /**\n   * Get player config\n   * @returns object\n   */\n  getConfig() {\n    return {\n      ...transform({\n        preset: this.preset,\n        chapters: this.chapters,\n        branding: this.branding,\n        analytics: !!this.analytics,\n        automations: !!this.automations,\n        autoplay: this.isAdmin ? false : !!this.autoplay,\n        blockAttributes: this.blockAttributes,\n        provider: this.provider,\n        youtube: this.youtube,\n        provider_video_id: this.provider_video_id,\n        i18n: this.i18n,\n        search: this.search,\n      }),\n      markers: { enabled: true, points: [] },\n      ...(this.iconUrl\n        ? {\n            iconUrl: this.iconUrl,\n          }\n        : {}),\n    };\n  }\n\n  /**\n   * Get player data\n   * @returns object\n   */\n  getPlayerData() {\n    return {\n      selector: this.playerEl,\n      src: this.src || '',\n      preload: this.preload,\n      provider: this.provider,\n      config: this.getConfig(),\n      isAdmin: this.isAdmin,\n    };\n  }\n\n  /**\n   * Create the video player\n   * @returns void\n   */\n  async createPlayer() {\n    return await createPlayer(this.getPlayerData());\n  }\n\n  @Watch('playerEl')\n  @Watch('player')\n  handlePlayerElementChange() {\n    hlsPreloadSize({\n      src: this.src,\n      el: this.playerEl,\n      preload: this.preload,\n      currentTime: this?.player?.currentTime,\n    });\n  }\n\n  /**\n   * Handle muted preview change\n   * @returns void\n   */\n  @Watch('mutedPreview')\n  handleMutedPreview(val, prev) {\n    if (!this.player || this.isAdmin) {\n      return;\n    }\n\n    // if it's been turned off\n    if (!val && prev) {\n      this.player.once('timeupdate', () => {\n        this.player.loop = this.preset?.on_video_end === 'loop';\n        this.player.toggleCaptions(this?.preset?.captions_enabled);\n      });\n    }\n\n    if (!this.originalConfig?.blockAttributes?.mutedPreview?.enabled) {\n      return;\n    }\n\n    // toggle muted autoplay in player\n    mutedAutoplay({\n      player: this.player,\n      mutedPreview: this.mutedPreview,\n      captions: !!this.blockAttributes?.mutedPreview?.captions,\n      progress: this.originalConfig?.ajaxProgress,\n      savePosition: this.originalConfig?.save_player_position,\n      onPlay: () => this.play(),\n    });\n  }\n\n  onPlayerReady() {\n    // reobserve\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer.observe(this.el);\n    }\n\n    // on ready\n    this.duration = this.player.duration;\n\n    // skip for iOS\n    var ua = window.navigator.userAgent;\n    var iOS = !!ua.match(/iPad/i) || !!ua.match(/iPhone/i);\n    if (!iOS) {\n      this.mutedPreview = this.blockAttributes?.mutedPreview?.enabled;\n    }\n\n    // inject UI\n    this.renderDynamicOverlays();\n    this.renderVideoCTA();\n    this.renderEmailOverlay();\n    this.renderSearchBar();\n\n    this.player.on('timeupdate loadedmetadata', () => {\n      this.duration = this.player.duration;\n      this.renderDynamicOverlays();\n    });\n\n    if (isHLS(this.src)) {\n      this.player.once('playing', () => {\n        this.playerEl.style.height = null;\n        this.playerEl.style.paddingBottom = null;\n        this.playerEl.setAttribute('hls_loaded', '1');\n      });\n    }\n\n    this.player.on('playing', () => (this.playClass = 'presto-player--playing'));\n    this.player.on('pause', () => (this.playClass = 'presto-player--paused'));\n    this.player.on('ended', () => (this.playClass = 'presto-player--ended'));\n\n    this.player.on('playing', e => !this.mutedPreview && this.currentMediaPlayer.emit(e.detail.plyr));\n    this.player.on('playing', e => this.playedMedia.emit(e.detail.plyr));\n    this.player.on('pause', e => this.pausedMedia.emit(e.detail.plyr));\n    this.player.on('ended', e => this.endedMedia.emit(e.detail.plyr));\n\n    // handle go to start.\n    if (this.preset?.on_video_end === 'go-to-start') {\n      this.player.on('ended', () => {\n        this.restart();\n        if (this.provider === 'youtube') {\n          this.stop();\n        }\n      });\n    }\n\n    cacheCues(this.player);\n    setTimeout(() => {\n      this.playerReady.emit(this.player);\n      this.ready = true;\n    }, 100);\n  }\n\n  /**\n   * Update player state with events\n   */\n  handlePlayerEvents(player) {\n    player.on('ready', e => {\n      this.player = e.detail.plyr;\n      this.onPlayerReady();\n    });\n  }\n\n  /**\n   * Handle lazy load changes\n   * @returns\n   */\n  @Watch('shouldLazyLoad')\n  handleLazyLoadChange() {\n    if (this.provider !== 'youtube' || this.shouldLazyLoad || this.isAdmin) {\n      return;\n    }\n\n    setTimeout(() => {\n      this.onReload('play');\n    }, 50);\n  }\n\n  /**\n   * Should we lazy load the video?\n   * @returns boolean\n   */\n  shouldLazyLoadVideo() {\n    if (this.provider !== 'youtube' || this.autoplay || this.blockAttributes?.mutedPreview?.enabled) {\n      return false;\n    }\n\n    return !!this.preset?.lazy_load_youtube;\n  }\n\n  /**\n   * Initialize data\n   */\n  componentWillLoad() {\n    const children = this.el.children?.[0];\n    children && children.classList && children.classList.contains('presto-iframe-fallback-container') && children.remove();\n    this.shouldLazyLoad = this.shouldLazyLoadVideo();\n    this.i18n = window?.prestoPlayer?.i18n || window?.prestoPlayerAdmin?.i18n;\n\n    // cache original config\n    if (!this.originalConfig) {\n      this.originalConfig = this.getConfig();\n    }\n\n    // track visibility\n    this.trackIntersection();\n  }\n\n  /**\n   * Create Player\n   */\n  async componentDidLoad() {\n    setTimeout(() => {\n      this.initialize();\n      this.loaded.emit(true);\n    }, 0);\n  }\n\n  /**\n   * Init player\n   * @returns plyr object\n   */\n  async initialize() {\n    const player = await this.createPlayer();\n    this.handlePlayerEvents(player);\n    this.syncVideoHeight();\n\n    customCSS(this.el, this.css);\n\n    return player;\n  }\n\n  renderSkins() {\n    if (this.preset?.skin === 'modern') {\n      return <presto-modern-skin></presto-modern-skin>;\n    } else if (this.preset?.skin === 'business') {\n      return <presto-business-skin></presto-business-skin>;\n    } else if (this.preset?.skin === 'stacked') {\n      return <presto-stacked-skin></presto-stacked-skin>;\n    }\n  }\n\n  /**\n   * On player reload\n   * @param ev\n   */\n  async onReload(action) {\n    const player = await this.initialize();\n\n    if (action == 'play') {\n      player.on('ready', () => {\n        this.play();\n        player.muted = true;\n        player.muted = false;\n        player.off('ready', this.play);\n      });\n    }\n  }\n\n  /**\n   * Sync video height as height changes\n   */\n  async syncVideoHeight() {\n    const resizeObserver = new ResizeObserver(() => {\n      if (!this.isSticky) {\n        this.videoHeight = this.el.getBoundingClientRect().height;\n      }\n    });\n    resizeObserver.observe(this.el);\n  }\n\n  @Listen('restartVideo')\n  handleRestartVideo() {\n    this.player.once('timeupdate', () => {\n      setTimeout(() => this.play(), 500);\n    });\n    this.player.restart();\n  }\n\n  @Listen('playVideo')\n  handlePlayVideo() {\n    this.play();\n  }\n\n  @Listen('pauseVideo')\n  handlePauseVideo(e) {\n    this.pause();\n    if (e.detail) {\n      exitFullScreen(this.player);\n    }\n  }\n\n  /**\n   * Handle tab visibility change\n   * @returns void\n   */\n  @Listen('visibilitychange', { target: 'window' })\n  playVideoOnlyInViewport() {\n    if (this.isAdmin || !this.preset?.play_video_viewport || !this.player) {\n      return;\n    }\n\n    if (document.visibilityState === 'visible') {\n      this.observer.observe(this.el);\n    } else {\n      if (this.player.playing) {\n        this.previouslyPlaying = true;\n      }\n      this.pause();\n      this.observer.disconnect();\n    }\n  }\n\n  /**\n   * Tracks the visibility of the video\n   * based on intersection\n   */\n  trackIntersection() {\n    this.observer = new IntersectionObserver(entries => {\n      this.handleVisibilityIntersection(entries?.[0]);\n    });\n    this.observer.observe(this.el);\n  }\n\n  /**\n   * Handle the intersection\n   * @param element\n   * @returns\n   */\n  handleVisibilityIntersection(element) {\n    if (!element) return;\n\n    // handle sticky\n    this.handleStickyScroll(element);\n    // handle viewport\n    this.handleVisibilityPlayChange(element);\n  }\n\n  /**\n   * Handle sticky scroll based on intersection\n   */\n  handleStickyScroll(element) {\n    if (!this.preset?.sticky_scroll) return;\n\n    // not in admin, muted preview or if not playing\n    if (this.isAdmin || this.mutedPreview || !this?.player?.playing) {\n      this.isSticky = false;\n      return;\n    }\n\n    let rect = element.boundingClientRect;\n    this.isSticky = rect.height < -rect.top;\n\n    // hide again when paused\n    if (document.visibilityState === 'visible') {\n      if (this.isSticky && this.player) {\n        const namedListener = () => {\n          window.removeEventListener('scroll', namedListener);\n          if (this.player.paused) {\n            this.isSticky = false;\n          }\n        };\n\n        this.player.once('pause', () => {\n          window.addEventListener('scroll', namedListener);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handle play change on visibility condition\n   * @param condition\n   * @returns\n   */\n  handleVisibilityPlayChange(element) {\n    if (this.isAdmin || !this.preset?.play_video_viewport) {\n      return;\n    }\n\n    // handle autoplay before load\n    if (!this.player && this.originalConfig.autoplay) {\n      this.previouslyPlaying = true;\n      this.autoplay = element?.isIntersecting ? true : false;\n    }\n\n    if (!this.player) return;\n\n    // intersecting\n    if (element?.isIntersecting) {\n      if (this.originalConfig.autoplay) {\n        this.autoplay = true;\n      }\n      this.previouslyPlaying && this.play();\n      this.previouslyPlaying = false;\n      return;\n    }\n\n    // not intersecting\n    if (document.visibilityState === 'visible') {\n      if (this.isSticky) {\n        return;\n      }\n    }\n\n    // handle muted preview\n    if (this.blockAttributes?.mutedPreview?.enabled) {\n      this.previouslyPlaying = true;\n      this.pause();\n      this.player.once('playing', () => {\n        this.previouslyPlaying = true;\n        this.pause();\n      });\n      return;\n    }\n\n    if (this.player.playing) {\n      this.previouslyPlaying = true;\n    }\n    this.pause();\n  }\n\n  /**\n   * Render the muted overlay\n   * @returns JSX\n   */\n  renderMutedOverlay() {\n    if (!this.player || !this.mutedPreview || this.isAdmin) {\n      return;\n    }\n\n    return (\n      <presto-muted-overlay\n        mutedOverlay={this.player.config.blockAttributes?.mutedOverlay}\n        preset={this.preset}\n        onPlayVideo={() => {\n          this.mutedPreview = false;\n          this.play();\n        }}\n      ></presto-muted-overlay>\n    );\n  }\n\n  /**\n   * Render the video\n   * @returns JSX\n   */\n  renderVideo() {\n    switch (this.provider) {\n      case 'vimeo':\n        return <presto-vimeo player={this.player} getRef={el => (this.playerEl = el as HTMLElement)} poster={this.poster} src={this.src}></presto-vimeo>;\n      case 'youtube':\n        return (\n          <presto-youtube\n            onReload={ev => this.onReload(ev?.detail)}\n            player={this.player}\n            getRef={el => (this.playerEl = el as HTMLElement)}\n            lazyLoad={this.shouldLazyLoad}\n            poster={this.poster}\n            src={this.src}\n          ></presto-youtube>\n        );\n      case 'bunny':\n        return (\n          <presto-bunny\n            thumbnail={this?.bunny?.thumbnail}\n            getRef={el => (this.playerEl = el as HTMLVideoElement)}\n            player={this.player}\n            autoplay={this.autoplay}\n            preload={this.preload}\n            poster={this.poster}\n            playsinline={this.playsinline}\n            src={this.src}\n            tracks={this.tracks}\n            videoAttributes={this.videoAttributes}\n          ></presto-bunny>\n        );\n      case 'audio':\n        return (\n          <presto-audio\n            getRef={el => (this.playerEl = el as HTMLAudioElement)}\n            player={this.player}\n            autoplay={this.autoplay}\n            preload={this.preload}\n            poster={this.poster}\n            preset={this.preset}\n            src={this.src}\n            tracks={this.tracks}\n            mediaTitle={this.mediaTitle}\n            audioAttributes={this.audioAttributes}\n          ></presto-audio>\n        );\n      default:\n        return (\n          <presto-video\n            getRef={el => (this.playerEl = el as HTMLVideoElement)}\n            player={this.player}\n            autoplay={this.autoplay}\n            preload={this.preload}\n            poster={this.poster}\n            playsinline={this.playsinline}\n            src={this.src}\n            tracks={this.tracks}\n            videoAttributes={this.videoAttributes}\n          ></presto-video>\n        );\n    }\n  }\n\n  renderVideoCTA() {\n    if (!window?.prestoPlayer?.isPremium) return;\n    if (this.isAdmin) return;\n    if (!this.preset?.cta?.enabled) return;\n    if (this.components.cta?.offsetParent) return;\n    if (this.provider === 'audio') return;\n\n    this.components.cta = document.createElement('presto-cta-overlay');\n    this.components.cta.direction = this.direction;\n    this.components.cta.player = this.player;\n    this.components.cta.preset = this.preset;\n    this.components.cta.i18n = this.i18n;\n\n    this.player.elements.container.append(this.components.cta);\n  }\n\n  renderAudioCTA() {\n    if (this.provider !== 'audio') return;\n    if (!this.player) return;\n    if (!this.preset?.cta?.enabled) return;\n    return <presto-cta-overlay direction={this.direction} player={this.player} preset={this.preset} i18n={this.i18n} provider={this.provider}></presto-cta-overlay>;\n  }\n\n  /**\n   * Render email overlay\n   * @returns JSX\n   */\n  renderEmailOverlay() {\n    if (!window?.prestoPlayer?.isPremium || this.isAdmin || window?.prestoPlayer?.logged_in) {\n      return;\n    }\n    if (this.components.email?.offsetParent) {\n      return;\n    }\n    if (this.provider === 'audio') return;\n\n    this.components.email = document.createElement('presto-email-overlay');\n    this.components.email.direction = this.direction;\n    this.components.email.player = this.player;\n    this.components.email.preset = this.preset;\n    this.components.email.i18n = this.i18n;\n    this.components.email.videoId = this.video_id;\n\n    this.player.elements.container.append(this.components.email);\n  }\n\n  renderAudioEmail() {\n    if (this.provider !== 'audio') return;\n    if (!this.player) return;\n    if (!window?.prestoPlayer?.isPremium || this.isAdmin || window?.prestoPlayer?.logged_in) return;\n    return <presto-email-overlay direction={this.direction} player={this.player} preset={this.preset} i18n={this.i18n} provider={this.provider}></presto-email-overlay>;\n  }\n  /**\n   * Render email overlay\n   * @returns JSX\n   */\n  renderActionBar() {\n    if (!this.preset?.action_bar?.enabled || !this.player) {\n      return;\n    }\n    return <presto-action-bar config={this.preset.action_bar} player={this?.player} youtube={this.youtube}></presto-action-bar>;\n  }\n\n  /**\n   * Render search overlay\n   * @returns JSX\n   */\n  renderSearchBar() {\n    if (!this.preset?.search?.enabled) {\n      return;\n    }\n    this.components.search = document.createElement('presto-search-bar');\n    this.components.search.player = this.player;\n    this.player.elements.container.append(this.components.search);\n  }\n\n  stickyPositionClass() {\n    if (!this.isSticky) {\n      return '';\n    }\n\n    return !!this.preset?.sticky_scroll_position ? `presto-sticky--${this.preset?.sticky_scroll_position.replace(/\\s+/g, '-')}` : 'presto-sticky--bottom-right';\n  }\n\n  /** We append this instead of using JSX because we want it to work in fullscreen. */\n  @Watch('overlays')\n  @Watch('preset')\n  renderDynamicOverlays() {\n    if (!this.player) {\n      return;\n    }\n\n    // is not visible, recreate.\n    if (!this?.overlaysComponent?.offsetParent) {\n      this.overlaysComponent = document.createElement('presto-dynamic-overlays');\n      this.overlaysComponent.addEventListener(\n        'reloadComponent',\n        () => {\n          this.overlaysComponent.remove();\n          this.overlaysComponent = document.createElement('presto-dynamic-overlays');\n        },\n        { once: true },\n      );\n    }\n\n    this.overlaysComponent.style.cssText = 'display: block !important; opacity: 1 !important; visibility: visible !important;';\n    this.overlaysComponent.overlays = this.overlays;\n    this.overlaysComponent.preset = this.preset;\n    this.overlaysComponent.player = this.player;\n    this.overlaysComponent.enabled = !this.player?.config?.mutedPreview?.enabled;\n\n    // has not yet been appended.\n    if (!this?.overlaysComponent?.offsetParent) {\n      this.player.elements?.wrapper?.append(this.overlaysComponent);\n    }\n  }\n\n  @Listen('ctaStateChange')\n  handleCtaStateChange(ev) {\n    this.ctaActive = ev.detail;\n  }\n\n  @Listen('emailStateChange')\n  handleEmailStateChange(ev) {\n    this.emailActive = ev.detail;\n  }\n  @Listen('actionBarStateChange')\n  handleActionBarStateChange(ev) {\n    this.actionBarActive = ev.detail;\n  }\n  /**\n   * Render the component\n   * @returns JSX\n   */\n  render() {\n    return (\n      <Host style={{ height: this.isSticky ? `${this.videoHeight}px` : 'auto' }} class={{'ready': this.ready}}>\n        <div\n          part=\"wrapper\"\n          dir={this.direction}\n          class={`presto-player__wrapper fitvidsignore\n          presto-video-id-${this.video_id}\n        ${!!this.isSticky ? (this.provider === 'audio' ? 'presto-sticky-audio' : 'presto-sticky') : ''}\n        ${this.provider !== 'audio' ? this.stickyPositionClass() : ''}\n        ${this.direction === 'rtl' ? 'rtl' : ''}\n        ${this.ctaActive === true ? 'cta-active' : ''}\n        ${this.emailActive === true ? 'email-active' : ''}\n        ${this.actionBarActive === true && this.preset?.action_bar?.enabled ? 'action-bar-active' : ''}\n        ${!!this.preset?.skin && `skin-${this.preset?.skin}`}\n        ${!!this.preset?.hide_youtube ? 'hide-youtube-ui' : ''}\n        ${!!this.preset?.caption_style ? `caption-style-${this.preset?.caption_style}` : ''}\n        ${!!this.mutedPreview ? 'is-muted-overlay' : ''}\n        ${this.playClass ? this.playClass : ''}\n        ${this.preset?.play && !this.preset['rewind'] ? 'rewind-inactive' : ''}\n        ${this.classes || ''}`}\n        >\n          <div>\n            <slot name=\"player-start\" />\n\n            <slot name=\"player-before-video\" />\n\n            {this.renderVideo()}\n\n            <slot name=\"player-after-video\" />\n\n            {this.renderActionBar()}\n\n            {this.renderMutedOverlay()}\n\n            {this.renderAudioCTA()}\n\n            {this.renderAudioEmail()}\n\n            {this.renderSkins()}\n\n            <slot name=\"player-end\" />\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n"]}